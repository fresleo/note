æˆ‘å°†ä¸ºä½ æä¾›çˆ¬è™«åˆ†æžé¡µé¢æ‰€éœ€çš„ä¸‰ä¸ªAPIæŽ¥å£çš„å®Œæ•´æ•°æ®ç»“æž„è®¾è®¡ã€‚

## ðŸ“¡ çˆ¬è™«åˆ†æž API æŽ¥å£è®¾è®¡

### 1ï¸âƒ£ çˆ¬è™«è¶‹åŠ¿æ•°æ®æŽ¥å£

**æŽ¥å£è·¯å¾„**ï¼š`/statistics/crawler/trend/list`

**è¯·æ±‚æ–¹æ³•**ï¼š`GET`

**è¯·æ±‚å‚æ•°**ï¼š
```javascript
{
  startDate: 1729987200000,    // èµ·å§‹æ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰
  endDate: 1730592000000,      // ç»“æŸæ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰
  domain: "avmonkey.tv",       // åŸŸå
  periodType: "daily",         // ç»Ÿè®¡å‘¨æœŸ: daily/weekly/monthly
  pageNum: 1,                  // é¡µç 
  pageSize: 100                // æ¯é¡µæ•°é‡
}
```

**è¿”å›žæ•°æ®ç»“æž„**ï¼š
```json
{
  "code": 200,
  "msg": "æŸ¥è¯¢æˆåŠŸ",
  "total": 7,
  "rows": [
    {
      "_id": {
        "timestamp": 1729987200,
        "date": "2025-10-20T00:00:00.000+08:00"
      },
      "date": "2025-10-20T00:00:00.000+08:00",
      "periodType": "daily",
      "domain": "avmonkey.tv",
      "crawlerCount": 342,           // çˆ¬è™«è®¿é—®æ¬¡æ•°
      "uniqueCrawlerCount": 15,      // å”¯ä¸€çˆ¬è™«æ•°é‡
      "createAt": "2025-10-27T14:00:00.168+08:00"
    },
    {
      "_id": {
        "timestamp": 1730073600,
        "date": "2025-10-21T00:00:00.000+08:00"
      },
      "date": "2025-10-21T00:00:00.000+08:00",
      "periodType": "daily",
      "domain": "avmonkey.tv",
      "crawlerCount": 428,
      "uniqueCrawlerCount": 18,
      "createAt": "2025-10-27T14:00:00.168+08:00"
    }
    // ... æ›´å¤šæ—¥æœŸæ•°æ®
  ]
}
```

---

### 2ï¸âƒ£ é¡µé¢çˆ¬å–æŽ’è¡ŒæŽ¥å£

**æŽ¥å£è·¯å¾„**ï¼š`/statistics/crawler/page/rank`

**è¯·æ±‚æ–¹æ³•**ï¼š`GET`

**è¯·æ±‚å‚æ•°**ï¼š
```javascript
{
  startDate: 1729987200000,    // èµ·å§‹æ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰
  endDate: 1730592000000,      // ç»“æŸæ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰
  domain: "avmonkey.tv",       // åŸŸå
  limit: 10,                   // è¿”å›žTOP Nï¼ˆé»˜è®¤10ï¼‰
  pageNum: 1,
  pageSize: 10
}
```

**è¿”å›žæ•°æ®ç»“æž„**ï¼š
```json
{
  "code": 200,
  "msg": "æŸ¥è¯¢æˆåŠŸ",
  "total": 10,
  "rows": [
    {
      "path": "/index.html",           // é¡µé¢è·¯å¾„
      "crawlerCount": 1234,            // çˆ¬è™«è®¿é—®æ¬¡æ•°
      "crawlerTypes": [                // è®¿é—®è¯¥é¡µé¢çš„çˆ¬è™«ç±»åž‹ç»Ÿè®¡
        {
          "type": "Googlebot",
          "count": 856
        },
        {
          "type": "Bingbot",
          "count": 245
        },
        {
          "type": "Baiduspider",
          "count": 133
        }
      ],
      "lastCrawlTime": "2025-10-27T14:23:45.000+08:00"  // æœ€åŽçˆ¬å–æ—¶é—´
    },
    {
      "path": "/about.html",
      "crawlerCount": 987,
      "crawlerTypes": [
        {
          "type": "Googlebot",
          "count": 654
        },
        {
          "type": "Bingbot",
          "count": 333
        }
      ],
      "lastCrawlTime": "2025-10-27T14:20:12.000+08:00"
    },
    {
      "path": "/products/list",
      "crawlerCount": 765,
      "crawlerTypes": [
        {
          "type": "Googlebot",
          "count": 432
        },
        {
          "type": "Baiduspider",
          "count": 333
        }
      ],
      "lastCrawlTime": "2025-10-27T14:18:30.000+08:00"
    }
    // ... æ›´å¤šé¡µé¢æŽ’è¡Œ
  ]
}
```

---

### 3ï¸âƒ£ å®žæ—¶çˆ¬è™«è¯¦æƒ…æŽ¥å£

**æŽ¥å£è·¯å¾„**ï¼š`/statistics/crawler/realtime/list`

**è¯·æ±‚æ–¹æ³•**ï¼š`GET`

**è¯·æ±‚å‚æ•°**ï¼š
```javascript
{
  domain: "avmonkey.tv",       // åŸŸå
  limit: 50                    // è¿”å›žæœ€è¿‘Næ¡ï¼ˆé»˜è®¤50ï¼‰
}
```

**è¿”å›žæ•°æ®ç»“æž„**ï¼š
```json
{
  "code": 200,
  "msg": "æŸ¥è¯¢æˆåŠŸ",
  "total": 50,
  "rows": [
    {
      "_id": "672d8f3a1b2c3d4e5f6a7b8c",
      "timestamp": 1730012595123,                        // è®¿é—®æ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰
      "date": "2025-10-27T14:23:15.123+08:00",          // æ ¼å¼åŒ–æ—¶é—´
      "domain": "avmonkey.tv",                          // åŸŸå
      "path": "/index.html",                            // è®¿é—®è·¯å¾„
      "ip": "66.249.66.1",                              // çˆ¬è™«IP
      "userAgent": "Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)",  // User Agent
      "crawlerType": "Googlebot",                       // çˆ¬è™«ç±»åž‹
      "referer": null,                                  // æ¥æºï¼ˆçˆ¬è™«é€šå¸¸ä¸ºnullï¼‰
      "statusCode": 200,                                // HTTPçŠ¶æ€ç 
      "responseTime": 125,                              // å“åº”æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
      "createAt": "2025-10-27T14:23:15.123+08:00"
    },
    {
      "_id": "672d8f3a1b2c3d4e5f6a7b8d",
      "timestamp": 1730012590456,
      "date": "2025-10-27T14:23:10.456+08:00",
      "domain": "avmonkey.tv",
      "path": "/products/detail/123",
      "ip": "157.55.39.171",
      "userAgent": "Mozilla/5.0 (compatible; bingbot/2.0; +http://www.bing.com/bingbot.htm)",
      "crawlerType": "Bingbot",
      "referer": null,
      "statusCode": 200,
      "responseTime": 89,
      "createAt": "2025-10-27T14:23:10.456+08:00"
    },
    {
      "_id": "672d8f3a1b2c3d4e5f6a7b8e",
      "timestamp": 1730012585789,
      "date": "2025-10-27T14:23:05.789+08:00",
      "domain": "avmonkey.tv",
      "path": "/api/data",
      "ip": "220.181.108.95",
      "userAgent": "Mozilla/5.0 (compatible; Baiduspider/2.0; +http://www.baidu.com/search/spider.html)",
      "crawlerType": "Baiduspider",
      "referer": null,
      "statusCode": 200,
      "responseTime": 234,
      "createAt": "2025-10-27T14:23:05.789+08:00"
    }
    // ... æ›´å¤šå®žæ—¶è®°å½•ï¼ˆæœ€å¤š50æ¡ï¼‰
  ]
}
```

---

### ðŸ”§ çˆ¬è™«ç±»åž‹æžšä¸¾ï¼ˆcrawlerTypeï¼‰

```javascript
const CrawlerTypes = {
  GOOGLEBOT: 'Googlebot',        // Google æœç´¢å¼•æ“Ž
  BINGBOT: 'Bingbot',            // Bing æœç´¢å¼•æ“Ž
  BAIDUSPIDER: 'Baiduspider',    // ç™¾åº¦æœç´¢å¼•æ“Ž
  YANDEXBOT: 'YandexBot',        // Yandex æœç´¢å¼•æ“Ž
  SOGOU: 'Sogou',                // æœç‹—æœç´¢å¼•æ“Ž
  YAHOO: 'Yahoo Slurp',          // Yahoo æœç´¢å¼•æ“Ž
  DUCKDUCKBOT: 'DuckDuckBot',    // DuckDuckGo æœç´¢å¼•æ“Ž
  FACEBOOKBOT: 'facebookexternalhit',  // Facebook çˆ¬è™«
  TWITTERBOT: 'Twitterbot',      // Twitter çˆ¬è™«
  LINKEDINBOT: 'LinkedInBot',    // LinkedIn çˆ¬è™«
  SEMRUSH: 'SemrushBot',         // SEO å·¥å…·çˆ¬è™«
  AHREFSBOT: 'AhrefsBot',        // SEO å·¥å…·çˆ¬è™«
  UNKNOWN: 'Unknown'             // æœªè¯†åˆ«çˆ¬è™«
}
```

---

### ðŸ“Š å­—æ®µè¯´æ˜Ž

#### **é€šç”¨å­—æ®µ**
- `_id`ï¼šMongoDB æ–‡æ¡£IDæˆ–å¤åˆé”®
- `timestamp`ï¼šUnix æ—¶é—´æˆ³ï¼ˆç§’æˆ–æ¯«ç§’ï¼‰
- `date`ï¼šISO 8601 æ ¼å¼çš„æ—¥æœŸæ—¶é—´å­—ç¬¦ä¸²
- `domain`ï¼šåŸŸå
- `createAt`ï¼šæ•°æ®åˆ›å»ºæ—¶é—´

#### **è¶‹åŠ¿æ•°æ®ç‰¹æœ‰å­—æ®µ**
- `crawlerCount`ï¼šçˆ¬è™«è®¿é—®æ€»æ¬¡æ•°
- `uniqueCrawlerCount`ï¼šå”¯ä¸€çˆ¬è™«æ•°é‡ï¼ˆæŒ‰IPæˆ–User AgentåŽ»é‡ï¼‰
- `periodType`ï¼šç»Ÿè®¡å‘¨æœŸï¼ˆdaily/weekly/monthlyï¼‰

#### **æŽ’è¡Œæ•°æ®ç‰¹æœ‰å­—æ®µ**
- `path`ï¼šé¡µé¢è·¯å¾„
- `crawlerTypes`ï¼šè®¿é—®è¯¥é¡µé¢çš„çˆ¬è™«ç±»åž‹åˆ†å¸ƒ
- `lastCrawlTime`ï¼šæœ€åŽä¸€æ¬¡è¢«çˆ¬å–çš„æ—¶é—´

#### **å®žæ—¶æ•°æ®ç‰¹æœ‰å­—æ®µ**
- `ip`ï¼šçˆ¬è™«IPåœ°å€
- `userAgent`ï¼šå®Œæ•´çš„User Agentå­—ç¬¦ä¸²
- `crawlerType`ï¼šè¯†åˆ«å‡ºçš„çˆ¬è™«ç±»åž‹
- `referer`ï¼šHTTP Refererï¼ˆçˆ¬è™«é€šå¸¸ä¸ºnullï¼‰
- `statusCode`ï¼šHTTPå“åº”çŠ¶æ€ç 
- `responseTime`ï¼šæœåŠ¡å™¨å“åº”æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰

---

### ðŸ’¡ å‰ç«¯ä½¿ç”¨ç¤ºä¾‹

```javascript
// 1. èŽ·å–çˆ¬è™«è¶‹åŠ¿
getCrawlerTrend({ 
  domain: 'avmonkey.tv', 
  startDate: Date.now() - 7*24*60*60*1000, 
  endDate: Date.now(),
  periodType: 'daily'
}).then(res => {
  const dates = res.rows.map(item => formatDate(item.date))
  const counts = res.rows.map(item => item.crawlerCount)
  renderCrawlerTrendChart(dates, counts)
})

// 2. èŽ·å–é¡µé¢æŽ’è¡Œ
getCrawlerPageRank({ 
  domain: 'avmonkey.tv', 
  limit: 10 
}).then(res => {
  const pages = res.rows.map(item => item.path)
  const counts = res.rows.map(item => item.crawlerCount)
  renderCrawlerRankChart(pages, counts)
})

// 3. èŽ·å–å®žæ—¶çˆ¬è™«ï¼ˆæ¯5ç§’è°ƒç”¨ï¼‰
setInterval(() => {
  getCrawlerRealtime({ domain: 'avmonkey.tv' }).then(res => {
    this.realtimeCrawlerData = res.rows
  })
}, 5000)
```

---

<!--stackedit_data:
eyJoaXN0b3J5IjpbMTkxNDE2NjMwNSwtMjAyNTMyNTc5XX0=
-->